{"ast":null,"code":"var _jsxFileName = \"/Users/ryandi/Documents/projects/react/game-of-life-functional/src/Game.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport './Game.css';\nimport HistoryStack from './HistoryStack';\nimport Tips from './Tips';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst WIDTH = 600;\nconst HEIGHT = 400;\nconst ROWS = 20;\nconst COLS = 30;\nlet BOARD = makeEmptyBoard();\n\nfunction Cell({\n  x,\n  y,\n  size\n}) {\n  let left = size * x + 1;\n  let top = size * y + 1;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"Cell\",\n    style: {\n      left,\n      top,\n      width: size - 1,\n      height: size - 1,\n      backgroundColor: `rgb(${top + 100}, ${left / 2}, ${top - 100})`\n    }\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 16,\n    columnNumber: 3\n  }, this);\n}\n\n_c = Cell;\nexport default function Game(props) {\n  _s();\n\n  // references\n  let boardRef = /*#__PURE__*/React.createRef();\n  let prevBtn = /*#__PURE__*/React.createRef(); // states\n\n  const [cells, setCells] = useState([]);\n  const [disablePrev, setDisablePrev] = useState(true);\n  const [HISTORY] = useState(new HistoryStack(10)); // disable the \"Prev\" button when `disablePrev` is true\n\n  useEffect(() => {\n    prevBtn.current.disabled = disablePrev;\n  }, [disablePrev]); // render\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"Board\",\n      style: {\n        width: WIDTH,\n        height: HEIGHT,\n        backgroundSize: `${props.size}px ${props.size}px`\n      },\n      ref: boardRef,\n      onClick: handleClick,\n      children: cells.map(cell => /*#__PURE__*/_jsxDEV(Cell, {\n        x: cell.x,\n        y: cell.y,\n        size: props.size\n      }, `${cell.x} ${cell.y}`, false, {\n        fileName: _jsxFileName,\n        lineNumber: 59,\n        columnNumber: 6\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"controls\",\n      style: {\n        width: WIDTH\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"btn\",\n        ref: prevBtn,\n        onClick: getPrevBoard,\n        children: \"Prev\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"btn\",\n        onClick: getNextBoard,\n        children: \"Next\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"btn\",\n        onClick: reset,\n        children: \"Reset\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 5\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(Tips, {\n      width: WIDTH\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 4\n    }, this)]\n  }, void 0, true);\n  /**\n   * Add or remove a cell on the board\n   * @param {MouseEvent} event\n   */\n\n  function handleClick(event) {\n    const elemOffset = getElementOffset(boardRef);\n    const offsetX = event.clientX - elemOffset.x;\n    const offsetY = event.clientY - elemOffset.y;\n    const x = Math.floor(offsetX / props.size);\n    const y = Math.floor(offsetY / props.size);\n    if (x >= 0 && x < COLS && y >= 0 && y < ROWS) BOARD[y][x] = !BOARD[y][x];\n    setCells(makeCells(BOARD));\n  }\n\n  function getNextBoard() {\n    HISTORY.push(new Array(...BOARD));\n    let newBoard = makeEmptyBoard();\n\n    for (let y = 0; y < ROWS; y++) {\n      for (let x = 0; x < COLS; x++) {\n        let neighbors = numberOfNeighbors(x, y);\n\n        if (BOARD[y][x]) {\n          newBoard[y][x] = neighbors === 2 || neighbors === 3 ? true : false;\n        } else {\n          if (!BOARD[y][x] && neighbors === 3) {\n            newBoard[y][x] = true;\n          }\n        }\n      }\n    }\n\n    BOARD = newBoard;\n    setCells(makeCells(BOARD));\n    setDisablePrev(false);\n  }\n\n  function getPrevBoard() {\n    let b = HISTORY.pop();\n\n    if (b) {\n      BOARD = b;\n      setCells(makeCells(BOARD));\n    }\n\n    if (HISTORY.size === 0) setDisablePrev(true);\n  }\n\n  function reset() {\n    HISTORY.clear();\n    BOARD = makeEmptyBoard();\n    setDisablePrev(true);\n    randomCells();\n  }\n\n  function randomCells() {\n    for (let y = 0; y < ROWS; y++) {\n      for (let x = 0; x < COLS; x++) {\n        BOARD[y][x] = Math.random() >= 0.5;\n      }\n    }\n\n    let cells = makeCells(BOARD);\n    setCells(cells);\n  }\n} // utility functions for boards and cells\n\n/**\n * Takes a game state board and returns the correpondings cells\n * which is an array of coordinates\n * @param {Array} b\n */\n\n_s(Game, \"bfbIQbXrwVp/0uNgxEYujBzuWGU=\");\n\n_c2 = Game;\n\nfunction makeCells(b) {\n  let cells = [];\n\n  for (let y = 0; y < ROWS; y++) {\n    for (let x = 0; x < COLS; x++) {\n      if (b[y][x]) cells.push({\n        x,\n        y\n      });\n    }\n  }\n\n  return cells;\n}\n/**\n * Return an empty board\n */\n\n\nfunction makeEmptyBoard() {\n  let result = [];\n\n  for (let y = 0; y < ROWS; y++) {\n    result.push([]);\n\n    for (let x = 0; x < COLS; x++) {\n      result[y].push(false);\n    }\n  }\n\n  return result;\n}\n/**\n * Calculates the number of neighbors for the cell at {x, y}\n * @param {Array} board\n * @param {number} x\n * @param {number} y\n */\n\n\nfunction numberOfNeighbors(x, y) {\n  let neighbors = 0;\n  const dirs = [[-1, -1], [-1, 0], [-1, 1], [0, 1], [1, 1], [1, -1], [0, -1]];\n\n  for (let i = 0; i < dirs.length; i++) {\n    let [offY, offX] = dirs[i];\n\n    let _y = y + offY;\n\n    let _x = x + offX;\n\n    if (_x >= 0 && _x < COLS && _y >= 0 && _y < ROWS && BOARD[_y][_x]) neighbors++;\n  }\n\n  return neighbors;\n}\n/**\n * Returns the offset of the board\n * @param {import('react').Ref} boardRef\n */\n\n\nfunction getElementOffset(boardRef) {\n  const rect = boardRef.current.getBoundingClientRect();\n  const doc = document.documentElement;\n  return {\n    x: rect.left + window.pageXOffset - doc.clientLeft,\n    y: rect.top + window.pageYOffset - doc.clientTop\n  };\n}\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"Cell\");\n$RefreshReg$(_c2, \"Game\");","map":{"version":3,"sources":["/Users/ryandi/Documents/projects/react/game-of-life-functional/src/Game.js"],"names":["React","useEffect","useState","HistoryStack","Tips","WIDTH","HEIGHT","ROWS","COLS","BOARD","makeEmptyBoard","Cell","x","y","size","left","top","width","height","backgroundColor","Game","props","boardRef","createRef","prevBtn","cells","setCells","disablePrev","setDisablePrev","HISTORY","current","disabled","backgroundSize","handleClick","map","cell","getPrevBoard","getNextBoard","reset","event","elemOffset","getElementOffset","offsetX","clientX","offsetY","clientY","Math","floor","makeCells","push","Array","newBoard","neighbors","numberOfNeighbors","b","pop","clear","randomCells","random","result","dirs","i","length","offY","offX","_y","_x","rect","getBoundingClientRect","doc","document","documentElement","window","pageXOffset","clientLeft","pageYOffset","clientTop"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport './Game.css';\nimport HistoryStack from './HistoryStack';\nimport Tips from './Tips';\n\nconst WIDTH = 600;\nconst HEIGHT = 400;\nconst ROWS = 20;\nconst COLS = 30;\nlet BOARD = makeEmptyBoard();\n\nfunction Cell({ x, y, size }) {\n\tlet left = size * x + 1;\n\tlet top = size * y + 1;\n\treturn (\n\t\t<div\n\t\t\tclassName=\"Cell\"\n\t\t\tstyle={{\n\t\t\t\tleft,\n\t\t\t\ttop,\n\t\t\t\twidth: size - 1,\n\t\t\t\theight: size - 1,\n\t\t\t\tbackgroundColor: `rgb(${top + 100}, ${left / 2}, ${top - 100})`,\n\t\t\t}}\n\t\t/>\n\t);\n}\n\nexport default function Game(props) {\n\t// references\n\tlet boardRef = React.createRef();\n\tlet prevBtn = React.createRef();\n\n\t// states\n\tconst [cells, setCells] = useState([]);\n\tconst [disablePrev, setDisablePrev] = useState(true);\n\tconst [HISTORY] = useState(new HistoryStack(10));\n\n\t// disable the \"Prev\" button when `disablePrev` is true\n\tuseEffect(() => {\n\t\tprevBtn.current.disabled = disablePrev;\n\t}, [disablePrev]);\n\n\t// render\n\treturn (\n\t\t<>\n\t\t\t{/* render game board */}\n\t\t\t<div\n\t\t\t\tclassName=\"Board\"\n\t\t\t\tstyle={{\n\t\t\t\t\twidth: WIDTH,\n\t\t\t\t\theight: HEIGHT,\n\t\t\t\t\tbackgroundSize: `${props.size}px ${props.size}px`,\n\t\t\t\t}}\n\t\t\t\tref={boardRef}\n\t\t\t\tonClick={handleClick}\n\t\t\t>\n\t\t\t\t{cells.map((cell) => (\n\t\t\t\t\t<Cell\n\t\t\t\t\t\tx={cell.x}\n\t\t\t\t\t\ty={cell.y}\n\t\t\t\t\t\tsize={props.size}\n\t\t\t\t\t\tkey={`${cell.x} ${cell.y}`}\n\t\t\t\t\t/>\n\t\t\t\t))}\n\t\t\t</div>\n\n\t\t\t{/* control panel */}\n\t\t\t<div\n\t\t\t\tclassName=\"controls\"\n\t\t\t\tstyle={{\n\t\t\t\t\twidth: WIDTH,\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<button className=\"btn\" ref={prevBtn} onClick={getPrevBoard}>\n\t\t\t\t\tPrev\n\t\t\t\t</button>\n\t\t\t\t<button className=\"btn\" onClick={getNextBoard}>\n\t\t\t\t\tNext\n\t\t\t\t</button>\n\t\t\t\t<button className=\"btn\" onClick={reset}>\n\t\t\t\t\tReset\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t\t<Tips width={WIDTH} />\n\t\t</>\n\t);\n\n\t/**\n\t * Add or remove a cell on the board\n\t * @param {MouseEvent} event\n\t */\n\tfunction handleClick(event) {\n\t\tconst elemOffset = getElementOffset(boardRef);\n\t\tconst offsetX = event.clientX - elemOffset.x;\n\t\tconst offsetY = event.clientY - elemOffset.y;\n\n\t\tconst x = Math.floor(offsetX / props.size);\n\t\tconst y = Math.floor(offsetY / props.size);\n\n\t\tif (x >= 0 && x < COLS && y >= 0 && y < ROWS)\n\t\t\tBOARD[y][x] = !BOARD[y][x];\n\t\tsetCells(makeCells(BOARD));\n\t}\n\n\tfunction getNextBoard() {\n\t\tHISTORY.push(new Array(...BOARD));\n\t\tlet newBoard = makeEmptyBoard();\n\n\t\tfor (let y = 0; y < ROWS; y++) {\n\t\t\tfor (let x = 0; x < COLS; x++) {\n\t\t\t\tlet neighbors = numberOfNeighbors(x, y);\n\t\t\t\tif (BOARD[y][x]) {\n\t\t\t\t\tnewBoard[y][x] =\n\t\t\t\t\t\tneighbors === 2 || neighbors === 3 ? true : false;\n\t\t\t\t} else {\n\t\t\t\t\tif (!BOARD[y][x] && neighbors === 3) {\n\t\t\t\t\t\tnewBoard[y][x] = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tBOARD = newBoard;\n\t\tsetCells(makeCells(BOARD));\n\t\tsetDisablePrev(false);\n\t}\n\n\tfunction getPrevBoard() {\n\t\tlet b = HISTORY.pop();\n\t\tif (b) {\n\t\t\tBOARD = b;\n\t\t\tsetCells(makeCells(BOARD));\n\t\t}\n\t\tif (HISTORY.size === 0) setDisablePrev(true);\n\t}\n\n\tfunction reset() {\n\t\tHISTORY.clear();\n\t\tBOARD = makeEmptyBoard();\n\t\tsetDisablePrev(true);\n\t\trandomCells();\n\t}\n\n\tfunction randomCells() {\n\t\tfor (let y = 0; y < ROWS; y++) {\n\t\t\tfor (let x = 0; x < COLS; x++) {\n\t\t\t\tBOARD[y][x] = Math.random() >= 0.5;\n\t\t\t}\n\t\t}\n\t\tlet cells = makeCells(BOARD);\n\t\tsetCells(cells);\n\t}\n}\n\n// utility functions for boards and cells\n\n/**\n * Takes a game state board and returns the correpondings cells\n * which is an array of coordinates\n * @param {Array} b\n */\nfunction makeCells(b) {\n\tlet cells = [];\n\tfor (let y = 0; y < ROWS; y++) {\n\t\tfor (let x = 0; x < COLS; x++) {\n\t\t\tif (b[y][x]) cells.push({ x, y });\n\t\t}\n\t}\n\treturn cells;\n}\n\n/**\n * Return an empty board\n */\nfunction makeEmptyBoard() {\n\tlet result = [];\n\tfor (let y = 0; y < ROWS; y++) {\n\t\tresult.push([]);\n\t\tfor (let x = 0; x < COLS; x++) {\n\t\t\tresult[y].push(false);\n\t\t}\n\t}\n\treturn result;\n}\n\n/**\n * Calculates the number of neighbors for the cell at {x, y}\n * @param {Array} board\n * @param {number} x\n * @param {number} y\n */\nfunction numberOfNeighbors(x, y) {\n\tlet neighbors = 0;\n\tconst dirs = [\n\t\t[-1, -1],\n\t\t[-1, 0],\n\t\t[-1, 1],\n\t\t[0, 1],\n\t\t[1, 1],\n\t\t[1, -1],\n\t\t[0, -1],\n\t];\n\n\tfor (let i = 0; i < dirs.length; i++) {\n\t\tlet [offY, offX] = dirs[i];\n\t\tlet _y = y + offY;\n\t\tlet _x = x + offX;\n\n\t\tif (_x >= 0 && _x < COLS && _y >= 0 && _y < ROWS && BOARD[_y][_x])\n\t\t\tneighbors++;\n\t}\n\treturn neighbors;\n}\n\n/**\n * Returns the offset of the board\n * @param {import('react').Ref} boardRef\n */\nfunction getElementOffset(boardRef) {\n\tconst rect = boardRef.current.getBoundingClientRect();\n\tconst doc = document.documentElement;\n\n\treturn {\n\t\tx: rect.left + window.pageXOffset - doc.clientLeft,\n\t\ty: rect.top + window.pageYOffset - doc.clientTop,\n\t};\n}\n"]},"metadata":{},"sourceType":"module"}